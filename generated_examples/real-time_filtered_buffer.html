
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>StreamReceiver: real-time buffer filtered with a causal filter &#8212; BSL 0.4.0 documentation</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/bsl-icon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python API Reference" href="../api_reference.html" />
    <link rel="prev" title="StreamReceiver: real-time alpha band power" href="real-time_regulation_of_alpha_waves.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/icon-with-acronym.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install.html">
  Install instructions
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api_reference.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../command_line.html">
  Command-Line
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/bsl-tools/bsl" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="resting_state_recording.html">
   StreamRecorder: resting-state recording
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="simulate_an_lsl_stream_with_a_stream_player.html">
   StreamPlayer: simulate an LSL stream
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="real-time_regulation_of_alpha_waves.html">
   StreamReceiver: real-time alpha band power
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   StreamReceiver: real-time buffer filtered with a causal filter
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filter">
   Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#buffer">
   Buffer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-the-filtered-buffer">
   Testing the filtered buffer
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-generated-examples-real-time-filtered-buffer-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="streamreceiver-real-time-buffer-filtered-with-a-causal-filter">
<span id="sphx-glr-generated-examples-real-time-filtered-buffer-py"></span><h1>StreamReceiver: real-time buffer filtered with a causal filter<a class="headerlink" href="#streamreceiver-real-time-buffer-filtered-with-a-causal-filter" title="Permalink to this headline">¶</a></h1>
<p>A <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> can be used to create a data buffer on which different
operations have already been applied. For instance, a buffer where data is
filtered with a bandpass filter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Mathieu Scheltienne &lt;mathieu.scheltienne@fcbg.ch&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: LGPL-2.1</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Both <a class="reference internal" href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamPlayer</span></code></a> and <a class="reference internal" href="../api/generated/bsl.StreamRecorder.html#bsl.StreamRecorder" title="bsl.StreamRecorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamRecorder</span></code></a> create a new process
to stream or record data. On Windows, mutliprocessing suffers a couple of
restrictions. The entry-point of a multiprocessing program should be
protected with <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__':</span></code> to ensure it can safely
import and run the module. More information on the
<a class="reference external" href="https://docs.python.org/2/library/multiprocessing.html#windows">documentation for multiprocessing on Windows</a>.</p>
</div>
<p>This example will use a sample EEG resting-state dataset that can be retrieve
with <a class="reference internal" href="../api/datasets.html#datasets"><span class="std std-ref">bsl.datasets</span></a>. The dataset is stored in the user home
directory in the folder <code class="docutils literal notranslate"><span class="pre">bsl_data</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">C:\Users\User\bsl_data</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/math.html#math.ceil" title="math.ceil" class="sphx-glr-backref-module-math sphx-glr-backref-type-py-function"><span class="n">ceil</span></a>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.butter.html#scipy.signal.butter" title="scipy.signal.butter" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">butter</span></a><span class="p">,</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.sosfilt.html#scipy.signal.sosfilt" title="scipy.signal.sosfilt" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">sosfilt</span></a><span class="p">,</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.sosfilt_zi.html#scipy.signal.sosfilt_zi" title="scipy.signal.sosfilt_zi" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">sosfilt_zi</span></a>

<span class="kn">from</span> <span class="nn">bsl</span> <span class="kn">import</span> <a href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class"><span class="n">StreamReceiver</span></a><span class="p">,</span> <a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class"><span class="n">StreamPlayer</span></a><span class="p">,</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">bsl.utils</span> <span class="kn">import</span> <span class="n">Timer</span>
</pre></div>
</div>
<p>To simulate an actual signal coming from an LSL stream, a <a class="reference internal" href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamPlayer</span></code></a>
is used with a 40 seconds resting-state recording. This dataset is already
filtered between (1, 40) Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a> <span class="o">=</span> <span class="s1">&#39;StreamPlayer&#39;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fif_file</span></a> <span class="o">=</span> <a href="../api/generated/bsl.datasets.eeg_resting_state.html#bsl.datasets.eeg_resting_state.data_path" title="bsl.datasets.eeg_resting_state.data_path" class="sphx-glr-backref-module-bsl-datasets-eeg_resting_state sphx-glr-backref-type-py-function"><span class="n">datasets</span><span class="o">.</span><span class="n">eeg_resting_state</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">player</span></a> <span class="o">=</span> <a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class"><span class="n">StreamPlayer</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fif_file</span></a><span class="p">)</span>
<a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer.start" title="bsl.StreamPlayer.start" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-method"><span class="n">player</span><span class="o">.</span><span class="n">start</span></a><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer" title="bsl.StreamPlayer" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">player</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Player: StreamPlayer | ON | /Users/scheltie/bsl_data/eeg_sample/resting_state-raw.fif&gt;
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fif_file</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BP filter between: </span><span class="si">{</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;highpass&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;lowpass&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>BP filter between: 1.0, 40.0 Hz
</pre></div>
</div>
<section id="filter">
<h2>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h2>
<p>Data should be filtered along one dimension. For this example, a butter IIR
filter is used. More information on filtering is available on the MNE
documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://mne.tools/stable/auto_tutorials/preprocessing/25_background_filtering.html#disc-filtering">Background information on filtering</a></p></li>
<li><p><a class="reference external" href="https://mne.tools/stable/auto_tutorials/preprocessing/30_filtering_resampling.html#tut-filter-resample">Filtering and resampling data</a></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_bandpass_filter</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a bandpass filter using a butter filter of order n.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    low : float</span>
<span class="sd">        The lower pass-band edge.</span>
<span class="sd">    high : float</span>
<span class="sd">        The upper pass-band ege.</span>
<span class="sd">    fs : float</span>
<span class="sd">        Sampling rate of the data.</span>
<span class="sd">    n : int</span>
<span class="sd">        Order of the filter.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sos : array</span>
<span class="sd">        Second-order sections representation of the IIR filter.</span>
<span class="sd">    zi_coeff : array</span>
<span class="sd">        Initial condition for sosfilt for step response steady-state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Divide by the Nyquist frequency</span>
    <span class="n">bp_low</span> <span class="o">=</span> <span class="n">low</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">bp_high</span> <span class="o">=</span> <span class="n">high</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
    <span class="c1"># Compute SOS output (second order sections)</span>
    <span class="n">sos</span> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.butter.html#scipy.signal.butter" title="scipy.signal.butter" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">butter</span></a><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="n">bp_low</span><span class="p">,</span> <span class="n">bp_high</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;band&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
    <span class="c1"># Construct initial conditions for sosfilt for step response steady-state.</span>
    <span class="n">zi_coeff</span> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.sosfilt_zi.html#scipy.signal.sosfilt_zi" title="scipy.signal.sosfilt_zi" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">sosfilt_zi</span></a><span class="p">(</span><span class="n">sos</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">sos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sos</span><span class="p">,</span> <span class="n">zi_coeff</span>
</pre></div>
</div>
<p>EEG data is usually subject to a lage DC offset, which corresponds to a step
response steady-state. The initial conditions are determined by multiplying
the <code class="docutils literal notranslate"><span class="pre">zi_coeff</span></code> with the DC offset. The DC offset value can be approximated
by taking the mean of a small window.</p>
</section>
<section id="buffer">
<h2>Buffer<a class="headerlink" href="#buffer" title="Permalink to this headline">¶</a></h2>
<p>When creating the filtered buffer, the duration has to be define to create a
numpy array of the correct shape and pre-allocate the required space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># in seconds</span>
</pre></div>
</div>
<p>Then, a <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> is created. But the actual buffer and window
size of the <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> are set as small as possible. The buffer
from the <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> is only used to store the last samples until
they are retrieved, filtered, and added to the filtered buffer. In this
example, the <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> buffer and window size are set to 200 ms.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="o">=</span> <a href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-class"><span class="n">StreamReceiver</span></a><span class="p">(</span><span class="n">bufsize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">winsize</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/time.html#time.sleep" title="time.sleep" class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span></a><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># wait to fill LSL inlet.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> opens an LSL inlet for each connected stream at
initialization. The inlet’s buffer is empty when created and fills up as
time passes. Data is pulled from the LSL inlet each time
<a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver.acquire" title="bsl.StreamReceiver.acquire"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acquire</span></code></a> is called.</p>
</div>
<p>The filtered buffer can be define as a class that uses the elements created
previously. The method <code class="docutils literal notranslate"><span class="pre">.update()</span></code> pulls new samples from the LSL stream,
filters and add them to the buffer while removing older samples that are now
exiting the buffer.</p>
<p>The <a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> appends a <code class="docutils literal notranslate"><span class="pre">TRIGGER</span></code> channel at the beginning of
the data array. For filtering, the trigger channel is not needed. Thus, the
number of channels is reduced by 1 and the first channel on the
<code class="docutils literal notranslate"><span class="pre">(samples,</span> <span class="pre">channels)</span></code> data array is ignored.</p>
<p>For this example, the filter is defined between 5 and 10 Hz to emphasize its
effect as the dataset streamed is already filtered between (1, 40) Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Buffer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A buffer containing filter data and its associated timestamps.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    buffer_duration : float</span>
<span class="sd">        Length of the buffer in seconds.</span>
<span class="sd">    sr : bsl.StreamReceiver</span>
<span class="sd">        StreamReceiver connected to the desired data stream.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
        <span class="c1"># Store the StreamReceiver in a class attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span> <span class="o">=</span> <span class="n">sr</span>

        <span class="c1"># Retrieve sampling rate and number of channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a><span class="p">]</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_channels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stream_name</span></a><span class="p">]</span><span class="o">.</span><span class="n">ch_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># Define duration</span>
        <span class="bp">self</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_duration_samples</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/math.html#math.ceil" title="math.ceil" class="sphx-glr-backref-module-math sphx-glr-backref-type-py-function"><span class="n">ceil</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>

        <span class="c1"># Create data array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_duration_samples</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_duration_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_channels</span><span class="p">))</span>
        <span class="c1"># For demo purposes, let&#39;s store also the raw data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_duration_samples</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">nb_channels</span><span class="p">))</span>

        <span class="c1"># Create filter BP (1, 15) Hz and filter variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zi_coeff</span> <span class="o">=</span> <span class="n">create_bandpass_filter</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zi</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the buffer with new samples from the StreamReceiver. This method</span>
<span class="sd">        should be called regularly, with a period at least smaller than the</span>
<span class="sd">        StreamReceiver buffer length.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Acquire new data points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="n">data_acquired</span><span class="p">,</span> <span class="n">ts_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="o">.</span><span class="n">reset_buffer</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># break early, no new samples</span>

        <span class="c1"># Remove trigger channel</span>
        <span class="n">data_acquired</span> <span class="o">=</span> <span class="n">data_acquired</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Filter acquired data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Initialize the initial conditions for the cascaded filter delays.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zi_coeff</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">data_acquired</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data_filtered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zi</span> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/reference/generated/scipy.signal.sosfilt.html#scipy.signal.sosfilt" title="scipy.signal.sosfilt" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">sosfilt</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sos</span><span class="p">,</span> <span class="n">data_acquired</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                         <span class="n">zi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zi</span><span class="p">)</span>

        <span class="c1"># Roll buffer, remove samples exiting and add new samples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.roll.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">,</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">):]</span> <span class="o">=</span> <span class="n">ts_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.roll.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">):,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data_filtered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.roll.html#numpy.roll" title="numpy.roll" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">roll</span></a><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">,</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ts_list</span><span class="p">):,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data_acquired</span>
</pre></div>
</div>
</section>
<section id="testing-the-filtered-buffer">
<h2>Testing the filtered buffer<a class="headerlink" href="#testing-the-filtered-buffer" title="Permalink to this headline">¶</a></h2>
<p>The filtered buffer must be updated regularly. In this example, the
<a class="reference internal" href="../api/generated/bsl.StreamReceiver.html#bsl.StreamReceiver" title="bsl.StreamReceiver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamReceiver</span></code></a> buffer has been initialized at 200 ms. Thus, the
filtered buffer should be updated at most every 200 ms, else, there is a risk
that a couple of samples will be missed between 2 updates.</p>
<p>A 15 seconds acquisition is used to test the buffer. Every 5 seconds, the
buffer is retrieved and plotted.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create plot</span>
<a href="https://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Raw data&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtered data between (5, 10) Hz&#39;</span><span class="p">)</span>
<span class="c1"># Create buffer</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="n">Buffer</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>

<span class="c1"># Start by filling once the entire buffer (to get rid of the initialization 0)</span>
<span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
<span class="k">while</span> <span class="n">timer</span><span class="o">.</span><span class="n">sec</span><span class="p">()</span> <span class="o">&lt;=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer_duration</span></a><span class="p">:</span>
    <span class="n">buffer</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="c1"># Acquire during 15 seconds and plot every 5 seconds</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">idx_last_plot</span></a> <span class="o">=</span> <span class="mi">1</span>
<span class="n">timer</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">while</span> <span class="n">timer</span><span class="o">.</span><span class="n">sec</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">:</span>
    <span class="n">buffer</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="c1"># check if we just passed the 5s between plot limit</span>
    <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">sec</span><span class="p">()</span> <span class="o">//</span> <span class="mi">5</span> <span class="o">==</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">idx_last_plot</span></a><span class="p">:</span>
        <span class="c1"># average all channels to simulate an evoked response</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer</span><span class="o">.</span><span class="n">timestamps</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer</span><span class="o">.</span><span class="n">raw_data</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer</span><span class="o">.</span><span class="n">timestamps</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">buffer</span><span class="o">.</span><span class="n">data</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">idx_last_plot</span></a> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_real-time_filtered_buffer_001.png" srcset="../_images/sphx_glr_real-time_filtered_buffer_001.png" alt="Raw data, Filtered data between (5, 10) Hz" class = "sphx-glr-single-img"/><p>Stop the mock LSL stream.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">sr</span>  <span class="c1"># disconnects and close the LSL inlet.</span>
<a href="../api/generated/bsl.StreamPlayer.html#bsl.StreamPlayer.stop" title="bsl.StreamPlayer.stop" class="sphx-glr-backref-module-bsl sphx-glr-backref-type-py-method"><span class="n">player</span><span class="o">.</span><span class="n">stop</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  22.744 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-examples-real-time-filtered-buffer-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/7511546f75174b1a1cfb2f9d8ce3db3e/real-time_filtered_buffer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">real-time_filtered_buffer.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/8f6968061ea26e7366ecfe1c950f4979/real-time_filtered_buffer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">real-time_filtered_buffer.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="real-time_regulation_of_alpha_waves.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">StreamReceiver: real-time alpha band power</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../api_reference.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python API Reference</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Kyuhwa Lee, Arnaud Desvachez, Mathieu Scheltienne, Last updated on 2022-02-21T15:37:01.198185+00:00.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>